/*
 * jquery-image-explode 1.0.6
 * A jQuery explosion plugin.
 * https://github.com/blackmiaool/jquery-image-explode#readme
 *
 * Copyright 2015, blackmiaool
 * Released under the MIT license.
*/

"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var a=0,i=Array(t.length);a<t.length;a++)i[a]=t[a];return i}return Array.from(t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){var a="explode-wrapper";t.fn.explodeRestore=function(){this.each(function(){var i=t(this),e=i.prop(a);e&&(e.replaceWith(i),i.prop(a,null))})},t.fn.explode=function(i){function e(t){function a(){var r=Date.now(),n=r-i;tt.clearRect(0,0,B,J),V.forEach(function(t){var a;tt.save();var i=t.width,r=t.height;tt.translate(t.biasx,t.biasy),tt.rotate(t.lastAngle||t.finalAngleRad),T&&(tt.beginPath(),tt.arc(0,0,i/2,0,2*Math.PI,!1),tt.closePath(),tt.clip());var o=void 0;o=n<t.time1?1:n>t.time2?0:1-(n-t.time1)/M,0!==o||t.released||(t.released=!0,e--),tt.globalAlpha=o,(a=tt).drawImage.apply(a,[G[0]].concat(_toConsumableArray(t.naturalParams),[-i/2,-r/2,i,r])),tt.restore()}),e?window.requestAnimationFrame(a):t&&t()}var i=Date.now(),e=V.length;V.forEach(function(t){t.time1=1e3/(t.ratio*($+1-t.width)/$+.1),t.time2=t.time1+M}),a()}function r(){setTimeout(function(){n(function(){G.explodeRestore()},!0)},R)}function n(t,a){function i(){var o=Date.now(),l=void 0,h=void 0;if(l=(o-r)/1e3,h=(o-e)/q,a&&(h=1-h),W)ot+=W*l*300;else{if(h>1||h<0)return void(t&&t());l*=Math.cos(h*Math.PI/2)*Math.PI/2}a&&(l=-l),r=o,tt.clearRect(0,0,B,J),V.forEach(function(t){var a;tt.save();var i=t.width,e=t.height;t.land||(t.biasx+=t.vx*l,t.biasy+=(t.vy+ot)*l,W&&t.biasy>t.transYMax&&(n--,t.land=!0,t.lastAngle=t.finalAngleRad*h,t.biasy=t.transYMax)),tt.translate(t.biasx,t.biasy),t.lastAngle?tt.rotate(t.lastAngle):tt.rotate(t.finalAngleRad*h),T&&(tt.beginPath(),tt.arc(0,0,i/2,0,2*Math.PI,!1),tt.closePath(),tt.clip()),(a=tt).drawImage.apply(a,[G[0]].concat(_toConsumableArray(t.naturalParams),[-i/2,-e/2,i,e])),tt.restore()}),W&&!n?t():window.requestAnimationFrame(i)}var e=Date.now(),r=e,n=V.length;a||V.forEach(function(t){t.vx=t.translateX/q*1e3,t.vy=t.translateY/q*1e3,t.biasx=t.translateX0,t.biasy=t.translateY0,t.transYMax=J/2+F-t.height/2}),i()}function o(t,a){return parseInt(Math.random()*(a+1-t),10)+t}function l(){V.forEach(function(t,a){var i=(Math.random()*C*2-C)/((Math.random()+2)*t.width)*10,e=i*(Math.PI/180),r=t.left+t.width/2-N/2,n=t.top+t.width/2-Q/2;0===r&&(r=a%2?-1:1),0===n&&(n=a%4<2?-1:1);var o=Math.sqrt(r*r+n*n),l=((1-U)*(1-(t.width-f)/($-f))+U)*Math.random();l=1-(1-l)*(1-y/m);var h=(m-o)*l+o,s=o*o,d=(h-o)*Math.sqrt((s-n*n)/s)*(r>0?1:-1),c=(h-o)*Math.sqrt((s-r*r)/s)*(n>0?1:-1),u=(B-N)/2+t.left+t.width/2,v=(J-Q)/2+t.top+t.height/2,p={finalDistance:h,ratio:l,x:r,y:n,distance:o,translateX:d,translateY:c,translateX0:u,translateY0:v,finalAngleRad:e,finalAngle:i};for(var g in p)t[g]=p[g]})}function h(){function t(t,a){return!(t<z[0]&&a>Q-z[0]||t>N-z[1]&&a>Q-z[1]||t>N-z[2]&&a<z[2]||t<z[3]&&a<z[3])}function a(t,a,i,e,r){return(t-i)*(t-i)+(a-e)*(a-e)<r*r}function i(i){var e=i.left,r=i.top,o=i.width,h=i.height,s=e,d=Q-r;(t(s,d)||z.some(function(t,i){return a(s,d,n[i][0]*N+2*(.5-n[i][0])*t,n[i][1]*Q+2*(.5-n[i][1])*t,t)}))&&l.push({left:e,top:r,width:o,height:h})}function e(t){function a(t){var a=e;if(e+=t,i({left:a,top:r,width:t,height:t}),E)for(var n=1;n<parseInt($/t);n++)i({left:a,top:r+n*t,width:t,height:t})}var e=0,r=t*$,n=void 0;do n&&a(n),n=o(f,$);while(N>e+n);N-e>=f&&a(N-e)}var r=void 0,n=[[0,1],[1,1],[1,0],[0,0]];r=v?Math.floor(Q/$):Math.ceil(Q/$);for(var l=[],h=0;h<r;h++)e(h);return l.sort(function(t,a){return Math.random()>.5?1:-1}),l}function s(){var t=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],a=G.width();return t=t.map(function(t){var i=G.css(t);return i.match(/px$/)?1*i.match(/^\d+/)[0]:i.match(/%$/)?i.match(/^\d+/)[0]/100*a:i})}i&&"object"===("undefined"==typeof i?"undefined":_typeof(i))||(i={});var d=i,c=d.minWidth,f=void 0===c?3:c,u=d.omitLastLine,v=void 0!==u&&u,p=d.radius,m=void 0===p?80:p,g=d.minRadius,y=void 0===g?0:g,b=d.release,w=void 0===b||b,x=d.fadeTime,M=void 0===x?300:x,A=d.recycle,P=void 0===A||A,I=d.recycleDelay,R=void 0===I?500:I,D=d.fill,E=void 0===D||D,Y=d.explodeTime,q=void 0===Y?300:Y,_=d.maxAngle,C=void 0===_?360:_,S=d.gravity,W=void 0===S?0:S,X=d.round,T=void 0!==X&&X,j=d.groundDistance,F=void 0===j?400:j,L=i,$=L.maxWidth,G=this,H=arguments;if(G.length>1)return void G.each(function(){var a=t(this);a.explode.apply(a,H)});if("IMG"===G.prop("tagName")&&!G.prop("complete"))return void G.on("load",function(){G.explode.apply(G,H)});var N=G.width(),Q=G.height(),k=Math.min(N,Q),z=s(),B=Math.max(N,2*m),J=Math.max(Q,2*m,2*F);$||($=k/4);var K=t("<div></div>",{class:a}),O=["width","height","margin-top","margin-right","margin-bottom","margin-left","position","top","right","bottom","left","float","display"];O.forEach(function(t){K.css(t,G.css(t))}),"static"===K.css("position")&&K.css("position","relative");var U=.3,V=h();l();var Z=void 0,tt=void 0,at=G[0],it=at.naturalWidth,et=at.naturalHeight;Z=t("<canvas></canvas>"),Z.css({position:"absolute",left:(N-B)/2,right:(N-B)/2,top:(Q-J)/2,bottom:(Q-J)/2,margin:"auto",width:B,height:J}),Z.attr({width:B,height:J}),K.append(Z);var rt=N/it,nt=Q/et;V.forEach(function(t){var a=t.left,i=t.top,e=t.width,r=t.height;tt=Z[0].getContext("2d"),t.naturalParams=[a/rt,i/nt,e/rt,r/nt]}),G.after(K),G.prop(a,K),G.detach();var ot=0;n(function(){w?e():P&&r()})}}(window.jQuery);