/*
 * jquery-image-explode 1.0.7
 * A jQuery explosion plugin.
 * https://github.com/blackmiaool/jquery-image-explode#readme
 *
 * Copyright 2015, blackmiaool
 * Released under the MIT license.
*/

"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var a=0,r=Array(t.length);a<t.length;a++)r[a]=t[a];return r}return Array.from(t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){var a="explode-wrapper";t.fn.explodeRestore=function(){this.each(function(){var r=t(this),e=r.prop(a);e&&(e.replaceWith(r),r.prop(a,null))})},t.fn.explode=function(r){function e(t){function a(){var i=Date.now(),n=i-r;tt.clearRect(0,0,B,J),V.forEach(function(t){var a;tt.save();var r=t.width,i=t.height;tt.translate(t.biasx,t.biasy),tt.rotate(t.lastAngle||t.finalAngleRad),T&&(tt.beginPath(),tt.arc(0,0,r/2,0,2*Math.PI,!1),tt.closePath(),tt.clip());var o=void 0;o=n<t.time1?1:n>t.time2?0:1-(n-t.time1)/M,0!==o||t.released||(t.released=!0,e--),tt.globalAlpha=o,(a=tt).drawImage.apply(a,[G[0]].concat(_toConsumableArray(t.naturalParams),[-r/2,-i/2,r,i])),tt.restore()}),e?window.requestAnimationFrame(a):t&&t()}var r=Date.now(),e=V.length;V.forEach(function(t){t.time1=1e3/(t.ratio*($+1-t.width)/$+.1),t.time2=t.time1+M}),a()}function i(){setTimeout(function(){n(function(){G.explodeRestore()},!0)},R)}function n(t,a){function r(){var o=Date.now(),l=void 0,h=void 0;if(l=(o-i)/1e3,h=(o-e)/q,a&&(h=1-h),W)ot+=W*l*300;else{if(h>1||h<0)return void(t&&t());l*=Math.cos(h*Math.PI/2)*Math.PI/2}a&&(l=-l),i=o,tt.clearRect(0,0,B,J),V.forEach(function(t){var a;tt.save();var r=t.width,e=t.height;t.land||(t.biasx+=t.vx*l,t.biasy+=(t.vy+ot)*l,W&&t.biasy>t.transYMax&&(n--,t.land=!0,t.lastAngle=t.finalAngleRad*h,t.biasy=t.transYMax)),tt.translate(t.biasx,t.biasy),t.lastAngle?tt.rotate(t.lastAngle):tt.rotate(t.finalAngleRad*h),T&&(tt.beginPath(),tt.arc(0,0,r/2,0,2*Math.PI,!1),tt.closePath(),tt.clip()),(a=tt).drawImage.apply(a,[G[0]].concat(_toConsumableArray(t.naturalParams),[-r/2,-e/2,r,e])),tt.restore()}),W&&!n?t():window.requestAnimationFrame(r)}var e=Date.now(),i=e,n=V.length;a||V.forEach(function(t){t.vx=t.translateX/q*1e3,t.vy=t.translateY/q*1e3,t.biasx=t.translateX0,t.biasy=t.translateY0,t.transYMax=J/2+F-t.height/2}),r()}function o(t,a){return parseInt(Math.random()*(a+1-t),10)+t}function l(){V.forEach(function(t,a){var r=(Math.random()*C*2-C)/((Math.random()+2)*t.width)*10,e=t.left+t.width/2-N/2,i=t.top+t.width/2-Q/2;0===e&&(e=a%2?-1:1),0===i&&(i=a%4<2?-1:1);var n=Math.sqrt(e*e+i*i),o=((1-U)*(1-(t.width-f)/($-f))+U)*Math.random();o=1-(1-o)*(1-y/m);var l=(m-n)*o+n,h=n*n,s={finalDistance:l,ratio:o,x:e,y:i,distance:n,translateX:(l-n)*Math.sqrt((h-i*i)/h)*(e>0?1:-1),translateY:(l-n)*Math.sqrt((h-e*e)/h)*(i>0?1:-1),translateX0:(B-N)/2+t.left+t.width/2,translateY0:(J-Q)/2+t.top+t.height/2,finalAngle:r,finalAngleRad:r*(Math.PI/180)};for(var d in s)t[d]=s[d]})}function h(){function t(t,a){return!(t<z[0]&&a>Q-z[0]||t>N-z[1]&&a>Q-z[1]||t>N-z[2]&&a<z[2]||t<z[3]&&a<z[3])}function a(t,a,r,e,i){return(t-r)*(t-r)+(a-e)*(a-e)<i*i}function r(r){var e=r.left,i=r.top,o=r.width,h=r.height,d=e,c=Q-i;(s||t(d,c)||z.some(function(t,r){return a(d,c,n[r][0]*N+2*(.5-n[r][0])*t,n[r][1]*Q+2*(.5-n[r][1])*t,t)}))&&l.push({left:e,top:i,width:o,height:h})}function e(t){function a(t){var a=e;if(e+=t,r({left:a,top:i,width:t,height:t}),E)for(var n=1;n<parseInt($/t);n++)r({left:a,top:i+n*t,width:t,height:t})}var e=0,i=t*$,n=void 0;do n&&a(n),n=o(f,$);while(N>e+n);N-e>=f&&a(N-e)}var i=void 0,n=[[0,1],[1,1],[1,0],[0,0]];i=v?Math.floor(Q/$):Math.ceil(Q/$);for(var l=[],h=0;h<i;h++)e(h);var s=z.every(function(t){return 0===t});return l.sort(function(t,a){return Math.random()>.5?1:-1}),l}function s(){var t=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],a=G.width();return t=t.map(function(t){var r=G.css(t);return r.match(/px$/)?1*r.match(/^\d+/)[0]:r.match(/%$/)?r.match(/^\d+/)[0]/100*a:r})}r&&"object"===("undefined"==typeof r?"undefined":_typeof(r))||(r={});var d=r,c=d.minWidth,f=void 0===c?3:c,u=d.omitLastLine,v=void 0!==u&&u,p=d.radius,m=void 0===p?80:p,g=d.minRadius,y=void 0===g?0:g,b=d.release,w=void 0===b||b,x=d.fadeTime,M=void 0===x?300:x,A=d.recycle,P=void 0===A||A,I=d.recycleDelay,R=void 0===I?500:I,D=d.fill,E=void 0===D||D,Y=d.explodeTime,q=void 0===Y?300:Y,_=d.maxAngle,C=void 0===_?360:_,S=d.gravity,W=void 0===S?0:S,X=d.round,T=void 0!==X&&X,j=d.groundDistance,F=void 0===j?400:j,L=r,$=L.maxWidth,G=this,H=arguments;if(G.length>1)return void G.each(function(){var a=t(this);a.explode.apply(a,H)});if("IMG"===G.prop("tagName")&&!G.prop("complete"))return void G.on("load",function(){G.explode.apply(G,H)});var N=G.width(),Q=G.height(),k=Math.min(N,Q),z=s(),B=Math.max(N,2*m),J=Math.max(Q,2*m,2*F);$||($=k/4);var K=t("<div></div>",{class:a}),O=["width","height","margin-top","margin-right","margin-bottom","margin-left","position","top","right","bottom","left","float","display"];O.forEach(function(t){K.css(t,G.css(t))}),"static"===K.css("position")&&K.css("position","relative");var U=.3,V=h();l();var Z=void 0,tt=void 0,at=G[0],rt=at.naturalWidth,et=at.naturalHeight;Z=t("<canvas></canvas>"),Z.css({position:"absolute",left:(N-B)/2,right:(N-B)/2,top:(Q-J)/2,bottom:(Q-J)/2,margin:"auto",width:B,height:J}),Z.attr({width:B,height:J}),K.append(Z);var it=N/rt,nt=Q/et;V.forEach(function(t){var a=t.left,r=t.top,e=t.width,i=t.height;tt=Z[0].getContext("2d"),t.naturalParams=[a/it,r/nt,e/it,i/nt]}),G.after(K),G.prop(a,K),G.detach();var ot=0;n(function(){w?e():P&&i()})}}(window.jQuery);